#!/bin/bash

#
# Collectd Autodiscovery - RRD
# ============================
#
# This script autogenerates the collectd config.

set -e
umask 0007


cat >> "/tmp/rrd.conf" <<- EOF
# Generated by $0 on `date`
# DO NOT MODIFY THIS FILE - it will be overwritten on server restart.
#

LoadPlugin rrdcached
#LoadPlugin rrdtool

<Plugin rrdcached>
       DaemonAddress "unix:/tmp/rrdcached.sock"
       DataDir "/var/lib/device/rrd"
       CreateFiles true
       CreateFilesAsync false
       CollectStatistics true
</Plugin>

#<Plugin rrdtool>
#       DataDir "/var/lib/collectd/rrd"
#       CreateFilesAsync false
#       CacheTimeout 120
#       CacheFlush   900
#       WritesPerSecond 50
#</Plugin>

EOF

install -m 644 "/tmp/rrd.conf" "/etc/collectd.d/rrd.conf"


